{% extends "_layouts/site" %}

{% block main %}
    <div class="container">
        {% include "_includes/heading" %}

        <div class="section">
            <div class="row justify-center -mb-6 sm:-mb-10">
                {% for product in craft.entries.section('products').all() %}
                    <div class="col flex sm:w-1/2 xl:w-1/3 max-w-xs mb-6 sm:mb-10">
                        <div class="card flex">
                            {% set image = product.productImage.one() %}
                            {% if image %}
                                <img class="card-img-top" src="{{ image.getUrl({ width: 400, height: 300, mode: 'crop' }) }}" alt="{{ image.title }}">
                            {% endif %}

                            <div class="card-body flex flex-col flex-1">
                                <h3 class="card-title">{{ product.title }}</h3>

                                <div class="wysiwyg mb-auto text-grey-60">
                                    {{ product.shortDescription }}
                                </div>

                                <div class="flex items-center">
                                    <p class="mr-auto text-xl">&pound;{{ product.price|number_format(2, '.', ',') }}</p>

                                    {{ craft.enupalStripe.paymentForm('product' ~ product.id) }}
                                </div>
                            </div>
                        </div>
                    </div>
                {% endfor %}
            </div>
        </div>

        <p class="text-sm text-grey-60 text-center">
            {% include "_includes/icons/lock_solid.svg" with { class: 'w-3 h-3 mr-1 align-baseline' } only %}
            Payments securely processed by <a class="underline hover:text-grey-80" href="https://stripe.com" target="_blank" rel="noreferrer noopener">Stripe</a>.
        </p>
    </div>
{% endblock %}
